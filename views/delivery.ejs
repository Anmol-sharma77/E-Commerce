<!DOCTYPE html>
<html> 
    <nav> 
        <h1>Shop Buddy</h1>
        <button id="home" class="cart" type="submit">Logout</button>
      </nav>
    <head>
        <style>
          *{
            margin:0;
            padding: 0;
            box-sizing: border-box;
          }
          nav {
    background-color:rgb(57, 56, 56);
    border-bottom: 1px solid #cccccc;
    width:100%;
    position: sticky;
    top:0;
    left: 0;
    margin-left: 0%;
    overflow: hidden;
    height: 120px;
  }
  .cart{
    width: 10%;
    padding: 12px;
    border: none;
    border-radius: 5px;
    background-color: #1cded8;
    color:white;
    font-size: 16px;
    float: right;
    cursor: pointer;
    margin-right: 10px;
  }
  .cart2{
    width: 30%;
    padding: 12px;
    border: none;
    border-radius: 5px;
    background-color: #1cded8;
    color:white;
    font-size: 16px;
    float: right;
    cursor: pointer;
    margin-right: 10px;
  }
  h1{
    text-align:center;
    font-family:'Times New Roman', Times, serif;
    font-size: 50px;
    color: white;
  }
  .img-container {
    border-radius: 10px;
    /* background-color:rgba(201, 198, 198, 0.593); */
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    width: 20%;
    height: 100%;
    display: block;
    flex-wrap: wrap;
}
  .product-container {
    border-radius: 10px;
    background-color:rgba(201, 198, 198, 0.593);
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    width: 95%;
    height: 200px;
    margin-top: 20px;
    margin-left: 40px;
    display: flex;
    flex-wrap: wrap;
}
.payment-container{
    border-radius: 10px;
    /* background-color:rgba(48, 45, 227, 0.593); */
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    width: 30%;
    height: 100%;
    display: block;
    flex-wrap: wrap;   
}
.detail-container {
    border-radius: 10px;
    padding: 10px;
    /* background-color:rgba(136, 227, 45, 0.593); */
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    width: 50%;
    height: 100%;
    display: block;
    flex-wrap: wrap;
}
img{
    width:100%;
    height:100%;
    background-color: #333;
    border-radius: 15px 0px 0px 15px;
    box-shadow:0px 0px 10px rgba(0, 0, 0, 0.1);
}
p{
    margin-top: 10px;
    margin-left: 20px;
    font-weight: 1000;
}
.btn{
    width:80px;
    height: 30px;
    border-radius: 5px;
    background-color:rgb(34, 36, 37);
    margin-top: 40px;
    margin-left: 10px;
    color: white;
}
h2{
    float: left;
    width: 100%;
}
.view{
    width:90px;
    height: 30px;
    margin-top: 20px;
    border-radius: 5px;
    background-color:steelblue;
    color: white;
}
.popup {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 999;
}
.popup-content {
  background-color:rgba(201, 198, 198, 0.593);
  max-width: 400px;
  margin: 20px auto;
  padding: 20px;
  border-radius: 5px;
  position: relative;
  text-align: center;
  color: white;
}
.close-button {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
  color: black
}
.close-button:hover {
  color: #e74c3c;
}
.container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
.title {
  font-size: 48px;
  color: #333;
  margin-bottom: 20px;
  margin-top: 100px;
}

.subtitle {
  font-size: 24px;
  color: #777;
  margin-bottom: 40px;
  text-align: center;
}

        </style>
        <title>Order Details</title>
    </head>
    <body>
        <div style="display:flex; flex-wrap: wrap;" id="div1">
    </div>
    <div class="container" style="display: none;"id="oops">
      <h1 class="title">Oops!!</h1>
      <h2 class="subtitle">No request </h2>
    </div>
    </body>
    <h3 style="text-align: center;">Â© 1996-2023, Shopbuddy.com, Inc. or its affiliates</h3>
    <script>
        const div2=document.getElementById("oops");
        const div=document.getElementById("div1");
const home =document.getElementById("home");
home.addEventListener("click",function(){
        window.location.href="/logout";
});
getorders(function(err,data){
    if(err)
    {
        console.log(err);
    }else if(data.length==0)
    {
      div.style.display="none";
      div2.style.display="block";
    }
    else
    {
        data.forEach(function(x){
            addtodom(x);
        });
    }
});
function getorders(callback){
    fetch("/deliverorders").then(function(response){
        if(response.status!=200)
        {
            callback("Something Went Wrong");
            return;
        }
        return response.json();
    }).then(function(data){
        callback(null,data);
        return;
    }).catch(function(error){
        console.log(error);
        callback("Error");
        return;
    })
}
function addtodom(data)
{
    const div1=document.createElement("div");
    const div2=document.createElement("div");
    const div3=document.createElement("div");
    const div4=document.createElement("div");
    const h2=document.createElement("h2");
    const p1=document.createElement("p");
    const p2=document.createElement("p");
    const p3=document.createElement("p");
    const p4=document.createElement("p");
    const p5=document.createElement("p");
    const p6=document.createElement("p");
    const p7=document.createElement("p");
    const p8=document.createElement("p");
    const p9=document.createElement("p");
    const p10=document.createElement("p");
    const img=document.createElement("img");
    const btn=document.createElement("button");
    div1.setAttribute("class","product-container");
    btn.setAttribute("class","cart2");
    div2.setAttribute("class","img-container");
    div3.setAttribute("class","detail-container");
    div4.setAttribute("class","payment-container");
    img.src=data.img;
    h2.innerHTML=data.product;
    btn.innerHTML="Delivered";
    p10.innerHTML="Total Price:"+data.totalbill;
    p4.innerHTML="Quantity:"+data.quantity;
    p1.innerHTML="Name:"+data.name;
    p2.innerHTML="Phone:"+data.phnum;
    p3.innerHTML="Address:"+data.address+','+data.city+','+data.district+','+data.state;
    p5.innerHTML="Pincode:"+data.pincode;
    p6.innerHTML="Payment Method:"+data.paymentmethod;
    p7.innerHTML="Order Status:"+data.ordstatus;
    p8.innerHTML="Order Date:"+data.placedDate;
    div.appendChild(div1);
    div1.appendChild(div2);
    div2.appendChild(img);
    div1.appendChild(div3);
    div1.appendChild(div4);
    div3.appendChild(h2);
    div3.appendChild(p4);
    div3.appendChild(p10);
    div3.appendChild(p1);
    div3.appendChild(p2);
    div3.appendChild(p3);
    div3.appendChild(p5);
    div4.appendChild(p6);
    div4.appendChild(p7);
    div4.appendChild(p8);
    div4.appendChild(p6);
    div4.appendChild(p9);
    div4.appendChild(btn);
    btn.addEventListener("click",function(){
      fetch("/deliveredbydeliverer",{
        method: 'POST',
        headers:{"content-type":"application/json"},
        body:JSON.stringify({"id":data.orderid})
      }).then(function(response){
            if(response.status==200)
            {
                div.removeChild(div1);
                if(!div.hasChildNodes())
                {
                div.style.display="none";
                div2.style.display="block";
                }
            }
        }).catch(function(error)
        {
            console.log("ERROR");
        });
    });
}
    </script>
</html>